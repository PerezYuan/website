"use strict";!function(e){function n(e){this.config={url:"",type:["jpg","png"],maxSize:10,multiple:!1,beforeSend:function(){console.log("开始上传...")},callback:function(e){console.log(e)},onProgress:function(e){console.log(e)}},this.init(e)}e("#st-stack").stackslider(),n.prototype={init:function(n){var t=this,o=n||{};t.config=e.extend(this.config,o),t.createElem()},createElem:function(){var n=this,t=this.$el=e("<input>");t.prop({id:"uploader",type:"file",name:"file",multiple:!!this.config.multiple}),t.trigger("click"),t.on("change",e.proxy(n.changeFile,n))},changeFile:function(){for(var n=new FormData,t=this,o=t.$el[0].files,i=0,c=o.length;i<c;i++){if(o[i].size>1024*t.config.maxSize*1024)return alert("请上传小于"+t.config.maxSize+"M的文件"),!1;var a=o[i].name.split(".").pop();if(t.config.type.indexOf(a.toLocaleLowerCase())==-1)return alert("暂不支持该类型的文件，请重新选择!"),!1;if("[object Function]"===Object.prototype.toString.call(t.config.beforeSend)&&t.config.beforeSend(t.$el)===!1)return!1;n.append("file"+i,o[i]),e.ajax({type:"post",url:"/ajax/upload",data:n,processData:!1,contentType:!1,xhr:function n(){var n=e.ajaxSettings.xhr();if("[object Function]"===Object.prototype.toString.call(t.config.onProgress)&&n.upload)return n.upload.addEventListener("progress",t.config.onProgress,!1),n}})}}},e(".upload-open").on("click",function(){}),e("#checkLove").on("click",function(){var n=e("input[name=answer]").val().trim();""===n?alert("请输入一生所爱~"):e.ajax({url:"/ajax/checklove",type:"post",data:"answer="+n,dataType:"json",async:!1,success:function(e){1==e.code||alert(e.msg)}})})}($);