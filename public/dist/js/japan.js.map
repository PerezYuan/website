{"version":3,"sources":["webpack:///webpack/bootstrap 3193b1203b3e871bbff5?639d","webpack:///./public/src/js/japan.js","webpack:///./public/src/js/util/uploader.js"],"names":["uploader","require","$","stackslider","$overlay","on","show","hide","answer","val","trim","alert","ajax","url","type","data","dataType","async","success","res","code","multiple","onProgress","event","pre","Math","floor","loaded","total","console","log","msg","option","config","maxSize","beforeSend","callback","init","prototype","me","extend","createElem","$up","$el","prop","id","name","click","proxy","changeFile","fd","FormData","files","i","ii","length","size","split","pop","indexOf","toLocaleLowerCase","Object","toString","call","append","processData","contentType","xhr","ajaxSettings","upload","addEventListener","module","exports"],"mappings":"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","file":"japan.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3193b1203b3e871bbff5","/**\r\n * @author perezyuan.\r\n * @time 2016/12/19.\r\n * @desc 照片墙核心逻辑\r\n */\r\nconst uploader = require('./util/uploader');\r\n(function ($) {\r\n    $('#st-stack').stackslider();\r\n\r\n    let $overlay = $('.overlay');\r\n    $('.J-upload-open').on('click',() => {\r\n        $overlay.show();\r\n    })\r\n\r\n    $('.J-upload-close').on('click',() => {\r\n        $overlay.hide();\r\n    })\r\n\r\n    $('#checkLove').on('click',() => {\r\n        let answer = $('input[name=answer]').val().trim();\r\n        if (answer === '') {\r\n            alert('请输入一生所爱~');\r\n        } else {\r\n            $.ajax({\r\n                url: '/ajax/checklove',\r\n                type: 'post',\r\n                data: `answer=${answer}`,\r\n                dataType: 'json',\r\n                async: false,\r\n                success(res) {\r\n                    if (res.code == 1) {\r\n                        new uploader({\r\n                            url: '/ajax/upload',\r\n                            multiple: true,\r\n                            type: ['jpg', 'png'],\r\n                            onProgress(event) {\r\n                                let pre = Math.floor(100 * event.loaded / event.total);\r\n                                console.log(pre);\r\n                            }\r\n                        })\r\n                    } else {\r\n                        alert(res.msg);\r\n                    }\r\n                }\r\n            })\r\n        }\r\n    })\r\n})($)\n\n\n// WEBPACK FOOTER //\n// ./public/src/js/japan.js","/**\r\n * @author perezyuan.\r\n * @time 2017/01/18.\r\n * @desc 上传组件.\r\n */\r\n\r\nfunction uploader(option) {\r\n    this.config = {\r\n        // 上传的路由\r\n        url: '',\r\n        // 上传的种类\r\n        type: ['jpg', 'png'],\r\n        // 最大上传限制\r\n        maxSize: 10,\r\n        // 是否允许一次上传多个\r\n        multiple: false,\r\n        // 上传之前\r\n        beforeSend() {\r\n            console.log(\"开始上传...\");\r\n        },\r\n        // 上传成功回调\r\n        callback(res) {\r\n            console.log(res);\r\n        },\r\n        onProgress(res) {\r\n            console.log(res);\r\n        }\r\n    }\r\n    this.init(option);\r\n}\r\n\r\nuploader.prototype = {\r\n    init(option) {\r\n        let me = this,\r\n            config = option || {};\r\n        me.config = $.extend(this.config, config);\r\n        me.createElem();\r\n    },\r\n    createElem() {\r\n        let me = this,\r\n            $up = this.$el = $('<input>');\r\n        $up.prop({\r\n            id: 'uploader',\r\n            type: 'file',\r\n            name: 'file',\r\n            multiple: this.config.multiple ? true : false\r\n        });\r\n        $up.click();\r\n        $up.on('change', $.proxy(me.changeFile, me))\r\n    },\r\n    changeFile() {\r\n        let fd = new FormData,\r\n            me = this,\r\n            files = me.$el[0].files;\r\n        for (let i = 0, ii = files.length; i < ii; i++) {\r\n            // 判断文件大小\r\n            if (files[i].size > me.config.maxSize * 1024 * 1024) {\r\n                alert('请上传小于' + me.config.maxSize + 'M的文件');\r\n                return false;\r\n            }\r\n            let type = files[i].name.split('.').pop();\r\n            if (me.config.type.indexOf(type.toLocaleLowerCase()) == -1) {\r\n                alert(\"暂不支持该类型的文件，请重新选择!\");\r\n                return false;\r\n            }\r\n            if (Object.prototype.toString.call(me.config.beforeSend) === '[object Function]') {\r\n                if (me.config.beforeSend(me.$el) === false) {\r\n                    return false;\r\n                }\r\n            }\r\n            fd.append('file' + i, files[i]);\r\n            $.ajax({\r\n                type: \"post\",\r\n                url: \"/ajax/upload\",\r\n                data: fd,\r\n                // 取消数据预处理\r\n                processData: false,\r\n                // 自动加上正确的Content-Type\r\n                contentType: false,\r\n                xhr: function () {\r\n                    let xhr = $.ajaxSettings.xhr();\r\n                    if (Object.prototype.toString.call(me.config.onProgress) === '[object Function]'\r\n                        && xhr.upload) {\r\n                        xhr.upload.addEventListener(\"progress\", me.config.onProgress, false);\r\n                        return xhr;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = uploader;\n\n\n// WEBPACK FOOTER //\n// ./public/src/js/util/uploader.js"],"sourceRoot":""}