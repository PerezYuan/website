{"version":3,"sources":["webpack:///webpack/bootstrap 367038626b6a99d77858?86f5","webpack:///./public/src/js/japan.js"],"names":["$","stackslider","uploader","option","config","url","type","maxSize","multiple","beforeSend","console","log","callback","res","onProgress","init","prototype","me","extend","createElem","$up","$el","prop","id","name","click","on","proxy","changeFile","fd","FormData","files","i","ii","length","size","alert","split","pop","indexOf","toLocaleLowerCase","Object","toString","call","append","ajax","data","processData","contentType","xhr","ajaxSettings","upload","addEventListener","answer","val","trim","dataType","async","success","code","event","pre","Math","floor","loaded","total","msg"],"mappings":"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","file":"japan.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 367038626b6a99d77858","/**\r\n * @author perezyuan.\r\n * @time 2016/12/19.\r\n * @desc\r\n */\r\n(function ($) {\r\n    $('#st-stack').stackslider();\r\n\r\n    function uploader(option) {\r\n        this.config = {\r\n            // 上传的路由\r\n            url : '',\r\n            // 上传的种类\r\n            type : ['jpg', 'png'],\r\n            // 最大上传限制\r\n            maxSize: 10,\r\n            // 是否允许一次上传多个\r\n            multiple: false,\r\n            // 上传之前\r\n            beforeSend() {\r\n                console.log(\"开始上传...\");\r\n            },\r\n            // 上传成功回调\r\n            callback(res) {\r\n                console.log(res);\r\n            },\r\n            onProgress(res) {\r\n                console.log(res);\r\n            }\r\n        }\r\n        this.init(option);\r\n    }\r\n\r\n    uploader.prototype = {\r\n        init(option) {\r\n            let me = this,\r\n                config = option || {};\r\n            me.config = $.extend(this.config, config);\r\n            me.createElem();\r\n        },\r\n        createElem() {\r\n            let me = this,\r\n                $up = this.$el = $('<input>');\r\n            $up.prop({\r\n                id: 'uploader',\r\n                type: 'file',\r\n                name: 'file',\r\n                multiple: this.config.multiple ? true : false\r\n            });\r\n            $up.click();\r\n            $up.on('change', $.proxy(me.changeFile, me))\r\n        },\r\n        changeFile() {\r\n            let fd = new FormData,\r\n                me = this,\r\n                files =  me.$el[0].files;\r\n            for (let i = 0, ii = files.length;i < ii; i++) {\r\n                // 判断文件大小\r\n                if(files[i].size > me.config.maxSize * 1024 * 1024) {\r\n                    alert('请上传小于' + me.config.maxSize + 'M的文件');\r\n                    return false;\r\n                }\r\n                let type = files[i].name.split('.').pop();\r\n                if(me.config.type.indexOf(type.toLocaleLowerCase()) == -1) {\r\n                    alert(\"暂不支持该类型的文件，请重新选择!\");\r\n                    return false;\r\n                }\r\n                if(Object.prototype.toString.call(me.config.beforeSend) === '[object Function]') {\r\n                    if(me.config.beforeSend(me.$el) === false){\r\n                        return false;\r\n                    }\r\n                }\r\n                fd.append('file' + i, files[i]);\r\n                $.ajax({\r\n                    type: \"post\",\r\n                    url: \"/ajax/upload\",\r\n                    data: fd,\r\n                    // 取消数据预处理\r\n                    processData : false,\r\n                    // 自动加上正确的Content-Type\r\n                    contentType : false ,\r\n                    xhr: function(){\r\n                        let xhr = $.ajaxSettings.xhr();\r\n                        if(Object.prototype.toString.call(me.config.onProgress) === '[object Function]'\r\n                            && xhr.upload) {\r\n                            xhr.upload.addEventListener(\"progress\", me.config.onProgress, false);\r\n                            return xhr;\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    $('.upload-open').on('click',() => {\r\n\r\n    })\r\n\r\n    $('#checkLove').on('click',() => {\r\n        let answer = $('input[name=answer]').val().trim();\r\n        if (answer === '') {\r\n            alert('请输入一生所爱~');\r\n        } else {\r\n            $.ajax({\r\n                url: '/ajax/checklove',\r\n                type: 'post',\r\n                data: `answer=${answer}`,\r\n                dataType: 'json',\r\n                async: false,\r\n                success(res) {\r\n                    if (res.code == 1) {\r\n                        new uploader({\r\n                            url: '/ajax/upload',\r\n                            multiple: true,\r\n                            type: ['jpg', 'png'],\r\n                            onProgress(event) {\r\n                                let pre = Math.floor(100 * event.loaded / event.total);\r\n                                console.log(pre);\r\n                            }\r\n                        })\r\n                    } else {\r\n                        alert(res.msg);\r\n                    }\r\n                }\r\n            })\r\n        }\r\n    })\r\n})($)\n\n\n// WEBPACK FOOTER //\n// ./public/src/js/japan.js"],"sourceRoot":""}